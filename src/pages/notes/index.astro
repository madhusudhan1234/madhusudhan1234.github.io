---
import BaseHead from "../../components/BaseHead.astro";
import Header from "../../components/Header.astro";
import Footer from "../../components/Footer.astro";
import { SITE_TITLE, SITE_DESCRIPTION } from "../../consts";
import { getCollection } from "astro:content";
import FormattedDate from "../../components/FormattedDate.astro";

const posts: any[] = (await getCollection("notes" as any)).sort(
  (a: any, b: any) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf(),
);
---

<!doctype html>
<html lang="en">
  <head>
    <BaseHead
      title={`Notes | Data Structures, JavaScript & Backend`}
      description={`Developer notes on JavaScript data structures, backend engineering, DevOps and practical tips.`}
    />
  </head>
  <body class="bg-[var(--navy)] text-[var(--slate)] font-sans antialiased">
    <Header />
    <main class="w-full max-w-6xl mx-auto px-6 md:px-12 pt-[110px] pb-12">
      <div class="mb-12">
        <h1
          class="text-3xl md:text-5xl font-bold text-[var(--lightest-slate)] mb-6"
        >
          Notes
        </h1>
        <p class="text-[var(--slate)] text-lg max-w-2xl">
          Developer notes on JavaScript data structures, backend engineering,
          DevOps and practical tips.
        </p>
      </div>

      <section>
        <ul class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
          {
            posts.map((post) => (
              <li class="group">
                <a
                  href={`/notes/${post.id}/`}
                  class="block h-full bg-[var(--light-navy)] rounded-xl overflow-hidden hover:-translate-y-2 transition-transform duration-300 shadow-lg"
                >
                  <div class="aspect-video w-full overflow-hidden relative bg-[var(--navy)]">
                    {post.data.heroImage ? (
                      <img
                        width={720}
                        height={360}
                        src={`/${post.data.heroImage}`}
                        alt={post.data.title}
                        loading="lazy"
                        decoding="async"
                        class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-110 opacity-80 group-hover:opacity-100 mix-blend-luminosity group-hover:mix-blend-normal"
                      />
                    ) : (
                      <img
                        width={720}
                        height={360}
                        src="/note-placeholder.svg"
                        alt="Placeholder"
                        loading="lazy"
                        decoding="async"
                        class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-110 opacity-50 group-hover:opacity-80 mix-blend-luminosity group-hover:mix-blend-normal"
                      />
                    )}
                  </div>
                  <div class="p-6">
                    <h4 class="text-xl font-bold text-[var(--lightest-slate)] mb-2 group-hover:text-[var(--green)] transition-colors line-clamp-2">
                      {post.data.title}
                    </h4>
                    <p class="text-[var(--light-slate)] text-sm font-mono mb-4">
                      <FormattedDate date={post.data.pubDate} />
                    </p>
                    {post.data.description && (
                      <p class="text-[var(--slate)] line-clamp-3 text-sm">
                        {post.data.description}
                      </p>
                    )}
                  </div>
                </a>
              </li>
            ))
          }
        </ul>
      </section>
    </main>
    <Footer />
  </body>
</html>
