---
import HeaderLink from "./HeaderLink.astro";
import { SITE_TITLE } from "../consts";
---

<header
	class="fixed top-0 z-50 w-full h-[70px] px-6 md:px-[50px] bg-[var(--navy)]/90 backdrop-blur-md transition-all border-b border-[var(--lightest-navy)] box-border flex justify-end"
>
	<nav
		class="flex justify-between items-center relative w-full h-full text-[var(--lightest-slate)] font-mono z-20"
	>
		<div class="logo">
			<a
				href="/"
				class="text-[var(--green)] text-base font-bold no-underline font-mono"
				>Madhu Sudhan Subedi</a
			>
		</div>

		<!-- Mobile Menu Toggle -->
		<button
			class="mobile-menu-toggle flex items-center justify-center md:hidden relative z-50 cursor-pointer bg-transparent border-none p-4 -mr-4"
			aria-label="Toggle menu"
		>
			<span class="hamburger-box relative inline-block w-[30px] h-[24px]">
				<span
					class="hamburger-inner block absolute top-1/2 -mt-[2px] w-[30px] h-[2px] bg-[var(--green)] rounded transition-transform duration-150 ease-linear before:content-[''] before:block before:w-[30px] before:h-[2px] before:bg-[var(--green)] before:rounded before:absolute before:-top-[10px] before:transition-all before:duration-150 after:content-[''] after:block after:w-[30px] after:h-[2px] after:bg-[var(--green)] after:rounded after:absolute after:-bottom-[10px] after:transition-all after:duration-150"
				></span>
			</span>
		</button>

		<!-- Desktop Nav -->
		<div class="hidden md:flex items-center">
			<ol class="flex justify-between items-center p-0 m-0 list-none">
				<li
					class="mx-[15px] relative text-[13px] counter-increment-item"
				>
					<a
						href="/"
						class="p-[10px] text-[var(--lightest-slate)] hover:text-[var(--green)] transition-colors"
						><span class="text-[var(--green)] text-xs mr-[5px]"
							>01.</span
						> Home</a
					>
				</li>
				<li
					class="mx-[15px] relative text-[13px] counter-increment-item"
				>
					<a
						href="/blog"
						class="p-[10px] text-[var(--lightest-slate)] hover:text-[var(--green)] transition-colors"
						><span class="text-[var(--green)] text-xs mr-[5px]"
							>02.</span
						> Blog</a
					>
				</li>
				<li
					class="mx-[15px] relative text-[13px] counter-increment-item"
				>
					<a
						href="/weekly"
						class="p-[10px] text-[var(--lightest-slate)] hover:text-[var(--green)] transition-colors"
						><span class="text-[var(--green)] text-xs mr-[5px]"
							>03.</span
						> Weekly</a
					>
				</li>
				<li
					class="mx-[15px] relative text-[13px] counter-increment-item"
				>
					<a
						href="/notes"
						class="p-[10px] text-[var(--lightest-slate)] hover:text-[var(--green)] transition-colors"
						><span class="text-[var(--green)] text-xs mr-[5px]"
							>04.</span
						> Notes</a
					>
				</li>
			</ol>
			<button
				id="theme-toggle"
				class="ml-6 p-2 text-[var(--lightest-slate)] hover:text-[var(--green)] transition-colors cursor-pointer"
				aria-label="Toggle theme"
			>
				<svg
					class="sun-icon hidden w-5 h-5"
					fill="none"
					stroke="currentColor"
					viewBox="0 0 24 24"
					xmlns="http://www.w3.org/2000/svg"
					><path
						stroke-linecap="round"
						stroke-linejoin="round"
						stroke-width="2"
						d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"
					></path></svg
				>
				<svg
					class="moon-icon hidden w-5 h-5"
					fill="none"
					stroke="currentColor"
					viewBox="0 0 24 24"
					xmlns="http://www.w3.org/2000/svg"
					><path
						stroke-linecap="round"
						stroke-linejoin="round"
						stroke-width="2"
						d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"
					></path></svg
				>
			</button>
		</div>

		<!-- Mobile Menu Overlay -->
		<div
			class="mobile-menu fixed top-0 bottom-0 right-0 w-[min(75vw,400px)] h-screen bg-[var(--light-navy)] shadow-[-10px_0px_30px_-15px_var(--navy-shadow)] z-40 translate-x-full transition-transform duration-250 ease-[cubic-bezier(0.645,0.045,0.355,1)] hidden md:hidden"
		>
			<nav class="flex flex-col text-center w-full justify-center h-full">
				<ol
					class="list-none p-0 m-0 w-full flex flex-col justify-center gap-5"
				>
					<li class="mx-auto mb-5 text-lg">
						<a
							href="/"
							class="inline-block no-underline text-[var(--lightest-slate)] p-[3px_20px_20px] w-full"
							><span
								class="block mb-[5px] text-[var(--green)] text-sm"
								>01.</span
							> Home</a
						>
					</li>
					<li class="mx-auto mb-5 text-lg">
						<a
							href="/blog"
							class="inline-block no-underline text-[var(--lightest-slate)] p-[3px_20px_20px] w-full"
							><span
								class="block mb-[5px] text-[var(--green)] text-sm"
								>02.</span
							> Blog</a
						>
					</li>
					<li class="mx-auto mb-5 text-lg">
						<a
							href="/weekly"
							class="inline-block no-underline text-[var(--lightest-slate)] p-[3px_20px_20px] w-full"
							><span
								class="block mb-[5px] text-[var(--green)] text-sm"
								>03.</span
							> Weekly</a
						>
					</li>
					<li class="mx-auto mb-5 text-lg">
						<a
							href="/notes"
							class="inline-block no-underline text-[var(--lightest-slate)] p-[3px_20px_20px] w-full"
							><span
								class="block mb-[5px] text-[var(--green)] text-sm"
								>04.</span
							> Notes</a
						>
					</li>
				</ol>
			</nav>
		</div>
	</nav>

	<!-- Side Navigation (Left) - Desktop Only -->
	<div
		class="home-subnav fixed left-10 bottom-0 z-10 w-10 md:flex flex-col items-center justify-center gap-8 h-screen bg-transparent hidden"
	>
		<div
			class="flex gap-8 items-center justify-center [writing-mode:vertical-rl]"
		>
			<a
				href="#about"
				class="rotate-180 p-2 text-[var(--light-slate)] font-mono text-sm tracking-widest hover:text-[var(--green)] transition-all no-underline"
				>About</a
			>
			<a
				href="#experience"
				class="rotate-180 p-2 text-[var(--light-slate)] font-mono text-sm tracking-widest hover:text-[var(--green)] transition-all no-underline"
				>Experience</a
			>
			<a
				href="#projects"
				class="rotate-180 p-2 text-[var(--light-slate)] font-mono text-sm tracking-widest hover:text-[var(--green)] transition-all no-underline"
				>Projects</a
			>
			<a
				href="#skills"
				class="rotate-180 p-2 text-[var(--light-slate)] font-mono text-sm tracking-widest hover:text-[var(--green)] transition-all no-underline"
				>Skills</a
			>
		</div>
	</div>
</header>

<script>
	const menuToggle = document.querySelector(".mobile-menu-toggle");
	const mobileMenu = document.querySelector(".mobile-menu");
	const body = document.querySelector("body");
	const main = document.querySelector("main");
	const footer = document.querySelector("footer");

	if (menuToggle && mobileMenu) {
		menuToggle.addEventListener("click", () => {
			const isActive = menuToggle.classList.toggle("active");
			mobileMenu.classList.toggle("translate-x-full");
			mobileMenu.classList.toggle("translate-x-0");
			mobileMenu.classList.toggle("hidden"); // Remove hidden to show
			mobileMenu.classList.toggle("flex"); // Add flex to layout

			if (body) body.classList.toggle("overflow-hidden");
			if (main) main.classList.toggle("blur-sm");
			if (footer) footer.classList.toggle("blur-sm");
		});
	}

	// Theme Toggle Logic
	const themeToggle = document.getElementById("theme-toggle");
	const sunIcon = document.querySelector(".sun-icon");
	const moonIcon = document.querySelector(".moon-icon");

	const updateIcons = (theme) => {
		if (theme === "dark") {
			sunIcon?.classList.remove("hidden");
			moonIcon?.classList.add("hidden");
		} else {
			sunIcon?.classList.add("hidden");
			moonIcon?.classList.remove("hidden");
		}
	};

	// Initialize icons based on current theme
	const currentTheme = localStorage.getItem("theme") || "light";
	updateIcons(currentTheme);

	if (themeToggle) {
		themeToggle.addEventListener("click", () => {
			const current = document.documentElement.getAttribute("data-theme");
			const newTheme = current === "dark" ? "light" : "dark";

			document.documentElement.setAttribute("data-theme", newTheme);
			localStorage.setItem("theme", newTheme);
			updateIcons(newTheme);
		});
	}
</script>

<style>
	/* Custom Hamburger Animations that are hard to do with just Tailwind utilities efficiently without bloating HTML */
	.mobile-menu-toggle.active .hamburger-inner {
		transform: rotate(225deg);
		transition-delay: 0.12s;
		transition-timing-function: cubic-bezier(0.215, 0.61, 0.355, 1);
	}

	.mobile-menu-toggle.active .hamburger-inner::before {
		top: 0;
		opacity: 0;
		transition:
			top 0.12s cubic-bezier(0.33333, 0, 0.66667, 0.33333),
			opacity 0.1s linear;
	}

	.mobile-menu-toggle.active .hamburger-inner::after {
		top: 0;
		transform: rotate(-90deg);
		transition:
			bottom 0.12s cubic-bezier(0.33333, 0, 0.66667, 0.33333),
			transform 0.22s cubic-bezier(0.215, 0.61, 0.355, 1) 0.12s;
	}
</style>
